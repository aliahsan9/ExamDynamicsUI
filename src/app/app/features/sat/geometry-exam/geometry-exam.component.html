<div class="container my-5" data-aos="fade-up">
  <h2 class="text-center fw-bold mb-4 text-primary">üìê Geometry Exam</h2>

  <!-- Progress Bar -->
  <div class="progress mb-4" *ngIf="score === null && questions.length > 0">
    <div
      class="progress-bar progress-bar-striped progress-bar-animated"
      role="progressbar"
      [style.width.%]="progress"
      [attr.aria-valuenow]="progress"
      aria-valuemin="0"
      aria-valuemax="100"
      [ngClass]="{
        'bg-danger': progress < 30,
        'bg-warning': progress >= 30 && progress < 70,
        'bg-success': progress >= 70
      }"
    >
      {{ progress | number : '1.0-0' }}%
    </div>
  </div>

  <div *ngIf="score === null">
    <div
      class="card mb-3 shadow-sm quiz-card"
      *ngFor="let q of questions; let i = index"
      data-aos="fade-up"
    >
      <div class="card-body">
        <h5 class="card-title">Q{{ i + 1 }}: {{ q.text }}</h5>
        <ul class="list-group list-group-flush mt-2">
          <li
            class="list-group-item"
            *ngFor="let o of optionsMap[q.questionId]"
          >
            <div class="form-check">
              <input
                class="form-check-input"
                type="radio"
                [name]="'q' + q.questionId"
                [value]="o.optionId"
                (change)="selectAnswer(q.questionId, o.optionId)"
                [checked]="answers[q.questionId] === o.optionId"
              />
              <label class="form-check-label">{{ o.text }}</label>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <div class="text-center mt-4">
      <button class="btn btn-success btn-lg" (click)="checkResults()">
        <i class="bi bi-check-circle"></i> Submit & Check Results
      </button>
    </div>
  </div>

  <div *ngIf="score !== null" class="text-center mt-5" data-aos="fade-up">
    <h3 class="text-success fw-bold">
      Your Score: {{ score }} / {{ questions.length }}
    </h3>
    <button class="btn btn-primary mt-3" (click)="resetExam()">
      <i class="bi bi-arrow-repeat"></i> Try Again
    </button>
  </div>
</div>
