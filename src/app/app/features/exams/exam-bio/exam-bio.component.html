<div class="container mt-4">
  <h2>Biology Exam</h2>

  <form [formGroup]="answersForm" (ngSubmit)="onSubmit()" *ngIf="questions.length > 0 && !submitted">
    <div *ngFor="let q of questions" class="mb-4 border p-3 rounded">
      <p><strong>Q{{ q.questionId }}:</strong> {{ q.text }}</p>

      <div *ngFor="let opt of getOptions(q.questionId)">
        <div class="form-check">
          <input class="form-check-input" type="radio" 
                 [value]="opt.text" 
                 [formControlName]="q.questionId.toString()"
                 [id]="'q' + q.questionId + '_opt' + opt.optionId">
          <label class="form-check-label" [for]="'q' + q.questionId + '_opt' + opt.optionId">
            {{ opt.text }}
          </label>
        </div>
      </div>
    </div>

    <button type="submit" class="btn btn-success">Submit Exam</button>
  </form>

  <!-- Result -->
  <div *ngIf="submitted">
    <h3>Your Score: {{ score }} / {{ questions.length }}</h3>

    <div *ngFor="let q of questions" class="mb-3 p-3 border rounded">
      <p><strong>Q{{ q.questionId }}:</strong> {{ q.text }}</p>
      <p>Your Answer: 
        <span [ngClass]="{'text-success': answersForm.get(''+q.questionId)?.value === q.correctAnswer,
                           'text-danger': answersForm.get(''+q.questionId)?.value !== q.correctAnswer}">
          {{ answersForm.get(''+q.questionId)?.value || 'No Answer' }}
        </span>
      </p>
      <p>Correct Answer: <span class="text-success">{{ q.correctAnswer }}</span></p>
    </div>
  </div>
</div>
