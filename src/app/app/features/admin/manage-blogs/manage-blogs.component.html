<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Manage Blogs</h2>
    <button class="btn btn-primary" (click)="openForm()">+ Add Blog</button>
  </div>

  <!-- Inline Form for Create/Edit -->
  <div *ngIf="showForm" class="card mb-4 p-3">
    <h5>{{ editingBlogId ? 'Edit Blog' : 'Add Blog' }}</h5>
    <form [formGroup]="blogForm" (ngSubmit)="saveBlog()" enctype="multipart/form-data">
      <div class="mb-3">
        <label class="form-label">Title</label>
        <input type="text" formControlName="title" class="form-control" />
      </div>

      <div class="mb-3">
        <label class="form-label">Content</label>
        <textarea formControlName="content" class="form-control" rows="5"></textarea>
      </div>

      <!-- Thumbnail Upload -->
      <div class="mb-3">
        <label class="form-label">Thumbnail</label>
        <input type="file" (change)="onFileSelected($event)" class="form-control" accept="image/*" />
      </div>

      <!-- Thumbnail Preview -->
      <div *ngIf="thumbnailPreview" class="mb-3">
        <label class="form-label">Preview</label><br />
        <img [src]="thumbnailPreview" alt="Thumbnail Preview" class="img-thumbnail" style="max-height: 150px;" />
      </div>

      <button type="submit" class="btn btn-success me-2">{{ editingBlogId ? 'Update' : 'Create' }}</button>
      <button type="button" class="btn btn-secondary" (click)="closeForm()">Cancel</button>
    </form>
  </div>

  <!-- Blogs Table -->
  <table class="table table-bordered table-hover">
    <thead class="table-light">
      <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Thumbnail</th>
        <th>Content</th>
        <th>Published At</th>
        <th>Actions</th> 
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let blog of blogs">
        <td>{{ blog.blogPostId }}</td>
        <td>{{ blog.title }}</td>
        <td>
          <img *ngIf="blog.thumbnailUrl" [src]="blog.thumbnailUrl" alt="Thumbnail" style="height: 60px; border-radius: 6px;" />
        </td>
        <td>{{ blog.content | slice:0:100 }}...</td>
        <td>{{ blog.publishedAt | date:'short' }}</td>
        <td>
          <button class="btn btn-sm btn-warning me-2" (click)="openForm(blog)">Edit</button>
          <button class="btn btn-sm btn-danger" (click)="deleteBlog(blog.blogPostId)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
