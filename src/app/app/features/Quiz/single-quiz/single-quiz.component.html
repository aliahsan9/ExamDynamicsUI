<div class="container py-4">
  <div *ngIf="!quizFinished && questions.length > 0">
    <h3 class="mb-4 text-primary">Quiz #{{ quizId }}</h3>

    <div class="card shadow-sm p-3">
      <h5>Q{{ currentIndex + 1 }}: {{ questions[currentIndex].text }}</h5>

      <ul class="list-group mt-3">
        <li *ngFor="let opt of optionsMap[questions[currentIndex].questionId]"
            class="list-group-item"
            [class.active]="selectedAnswers[questions[currentIndex].questionId] === opt.optionId"
            (click)="selectOption(questions[currentIndex].questionId, opt.optionId)">
          {{ opt.text }}
        </li>
      </ul>

      <div class="mt-3 d-flex justify-content-between">
        <button class="btn btn-secondary" (click)="prevQuestion()" [disabled]="currentIndex === 0">
          Previous
        </button>
        <button class="btn btn-primary" (click)="nextQuestion()" [disabled]="currentIndex === questions.length - 1">
          Next
        </button>
      </div>

      <div class="mt-3 text-center" *ngIf="currentIndex === questions.length - 1">
        <button class="btn btn-success" (click)="submitQuiz()" [disabled]="getAnsweredCount() < questions.length">
          Submit Quiz
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="quizFinished" class="text-center">
    <h2 class="text-success">ðŸŽ‰ Quiz Finished!</h2>
    <p class="lead">You scored {{ score }} / {{ questions.length }}</p>
    <button class="btn btn-outline-primary" (click)="restartQuiz()">Restart</button>
    <button class="btn btn-outline-dark ms-2" (click)="router.navigate(['/quiz'])">Back to Quizzes</button>
  </div>

  <div *ngIf="!quizFinished && questions.length === 0" class="alert alert-warning mt-4">
    No questions found for this quiz.
  </div>
</div>
